---
generic:
  #prompt: '(?P<hostname>[\w\-]+)[#>]'
  prompt: '(?P<hostname>.*)[#>]'
  prompt_dynamic: '{prompt}[#>]'
  username: '[U|u]sername:\s|login:\s?'
  password: '[P|p]assword:\s?'
  passowrd_filter: '[s]ftp://.*:(.*)@")'

  rommon:
    - XR
    - XR64
    - IOS
    - NX-OS
  standby:
    - XR
    - XR64
    - NX-OS
    - IOS
  syntax_error:
    - XR
    - XR64
    - IOS
    - NX-OS
    - jumphost
    - Calvados

  press_return: 'Press RETURN to get started\.'
  more: ' --More-- '
  connection_closed:
    pattern: 'Connection closed'
    description: 'Connection closed'
  buffer_overflow:
    pattern: 'Error: input buffer overflow'
    description: 'Command too long'

  unable_to_connect:
    pattern: 'nodename nor servname provided, or not known|
      [Uu]nknown host|
      [Oo]peration timed out|
      [Cc]onnection timed out|
      [Dd]estination unreachable|
      [Uu]nable to connect|
      [Cc]onnection refused|
      command not found|
      reset by peer|
      closed by foreign host'



jumphost:
  prompt: '\$\s?|>\s?|#\s?|%\s?|\[.*:~\]'
  # do not match 'Last login: Wed ....'
  username: '[U|u]sername:\s|^.*(?<![Ll]ast )login:'
  password: '[P|p]assword:\s?$'
  syntax_error:
    pattern: 'command not found'
    description: 'Command syntax error'


XR:
  prompt: 'RP\/\d+\/RS?P[0-1]\/CPU[0-3]:(?P<hostname>.*?)(\([^()]*\))?#'
  prompt_dynamic: '{prompt}(\([^()]*\))?#'
  prompt_default: 'RP/[0-3]/RS?P[0-1]/CPU[0-1]:ios#'
  rommon: 'rommon \d+ >'
  xml: 'XML> '
  username: '[Uu]sername: '
  password: '[Pp]assword: '
  standby: 'This \(D\)RP Node is not ready or active for login /configuration'
  syntax_error:
    # double ' to escape
    pattern: '% Invalid input detected at ''\^'' marker\.|% Incomplete command\.|% Ambiguous command:'
    description: "Command syntax error"


XR64:
  prompt: 'RP\/\d+\/RS?P[0-1]\/CPU[0-3]:(?P<hostname>.*?)(\([^()]*\))?#'
  prompt_dynamic: '{prompt}(\([^()]*\))?#'
  prompt_default: 'RP/[0-3]/RS?P[0-1]/CPU[0-1]:ios#'
  rommon: 'rommon \d+ >'
  xml: 'XML> '
  calvados: 'sysadmin-vm:?(?:_node)?[0-3]_RS?P[0-1]:?.*#'
  username: '[Uu]sername: '
  password: '[Pp]assword: '
  standby: 'This \(D\)RP Node is not ready or active for login /configuration'
  syntax_error:
    pattern: '% Invalid input detected at ''\^'' marker\.|% Incomplete command\.|% Ambiguous command:|syntax error: unknown argument'
    description: 'Command syntax error'

IOS:
  prompt: '^(?P<hostname>[\w\-\_\=\+]+)(\([^()]*\))?[#|>]'
  prompt_dynamic: '{prompt}(\([^()]*\))?[#>]'
  prompt_default: 'Router[#>]'
  rommon: 'rommon \d+ >|rommon>'
  password: 'Password: '
  username: 'Username: '
  standby: 'Standby console disabled'
  syntax_error:
    pattern: '% Bad IP address or host name% Unknown command or computer name, or unable to find computer address|% Invalid input detected at ''\^'' marker\.|% Type "show \?" for a list of subcommands|% Ambiguous command:|% Incomplete command\.'
    description: 'Command syntax error'


NX-OS:
  prompt: '^(?P<hostname>.*?)(\([^()]*\))?#'
  prompt_dynamic: '{prompt}(\([^()]*\))?#'
  prompt_default: 'switch#'
  password: 'Password: '
  username: '(.*?) login: '
  rommon: 'loader >'
  standby: '\(standby\)'
  syntax_error: '% Invalid command at ''\^'' marker\.|% Incomplete command at ''\^'' marker\.'

Calvados:
  prompt: '^sysadmin-vm:?(?:_node)?[0-3]_RS?P[0-1]:?(?P<hostname>.*?)(\([^()]*\))?#'
  prompt_dynamic: '{prompt}(\([^()]*\))?#'
  prompt_default: 'sysadmin-vm:?(?:_node)?[0-3]_RS?P[0-1]#'
  password: 'Password: '
  username: 'System Admin Username: '
  syntax_error: 'syntax error: expecting'

